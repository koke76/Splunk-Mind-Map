<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Splunk Mind Map</title>
<script type="text/javascript" src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
<link href="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.css" rel="stylesheet" type="text/css" />
<style>
  #network { width: 100%; height: 90vh; border: 1px solid lightgray; }
  #infoBox { margin-top:10px; padding:10px; border:1px solid #ccc; background:#f9f9f9; border-radius:5px; }
</style>
</head>
<body>

<h1>Professional Splunk Mind Map</h1>
<div id="network"></div>
<div id="infoBox">Click on an Event ID or command to see details here.</div>

<script>
  // Nodes data
  const nodes = new vis.DataSet([
    { id: 1, label: "Splunk", color:"#FFDD57", type:"root" },

    // Usage
    { id: 2, label: "Usage", color:"#FFAAAA", type:"category" },
    { id: 3, label: "Search", color:"#FFAAAA", type:"category" },
    { id: 4, label: "Operators", color:"#FFAAAA", type:"category" },

    // Commands
    { id: 5, label: "Commands", color:"#AAFFAA", type:"category" },
    { id: 6, label: "stats", color:"#AAFFAA", type:"command", info: "Aggregate and calculate values.\nExample: index=main | stats count by Account_Name" },
    { id: 7, label: "table", color:"#AAFFAA", type:"command", info: "Display specific columns.\nExample: index=main | table _time, Account_Name" },
    { id: 8, label: "sort", color:"#AAFFAA", type:"command", info: "Sort results.\nExample: index=main | sort -_time" },
    { id: 9, label: "top", color:"#AAFFAA", type:"command", info: "Show most frequent values.\nExample: index=main | top Account_Name" },
    { id:10, label: "rare", color:"#AAFFAA", type:"command", info: "Show least frequent values.\nExample: index=main | rare Account_Name" },
    { id:11, label: "rex", color:"#AAFFAA", type:"command", info: "Extract patterns using Regex.\nExample: index=main | rex field=_raw \"User=(?<user>\\w+)\"" },
    { id:12, label: "fields", color:"#AAFFAA", type:"command", info: "Include or exclude fields.\nExample: index=main | fields _time, Account_Name" },

    // Event IDs
    { id:13, label:"Event IDs", color:"#AAAAFF", type:"category" },
    { id:14, label:"4624", color:"#AAAAFF", type:"event", info:"Successful logon.\nExample: index=wineventlog EventCode=4624 | stats count by Account_Name" },
    { id:15, label:"4625", color:"#AAAAFF", type:"event", info:"Failed logon.\nExample: index=wineventlog EventCode=4625 | stats count by Account_Name" },
    { id:16, label:"4634", color:"#AAAAFF", type:"event", info:"Logoff.\nExample: index=wineventlog EventCode=4634 | table Account_Name, _time" },
    { id:17, label:"4647", color:"#AAAAFF", type:"event", info:"User-initiated logoff.\nExample: index=wineventlog EventCode=4647 | table Account_Name, _time" },
    { id:18, label:"4672", color:"#AAAAFF", type:"event", info:"Special privileges assigned to new logon.\nExample: index=wineventlog EventCode=4672 | stats count by Account_Name" }
  ]);

  // Edges
  const edges = new vis.DataSet([
    { from:1, to:2 }, { from:1, to:5 }, { from:1, to:13 },
    { from:2, to:3 }, { from:2, to:4 },
    { from:5, to:6 }, { from:5, to:7 }, { from:5, to:8 }, { from:5, to:9 }, { from:5, to:10 }, { from:5, to:11 }, { from:5, to:12 },
    { from:13, to:14 }, { from:13, to:15 }, { from:13, to:16 }, { from:13, to:17 }, { from:13, to:18 }
  ]);

  // Create network
  const container = document.getElementById('network');
  const data = { nodes: nodes, edges: edges };
  const options = {
    layout: { hierarchical: { direction: 'UD', sortMethod: 'directed' } },
    nodes: { shape: 'ellipse', font: { size:14 } },
    edges: { smooth: true },
    interaction: { hover: true, tooltipDelay: 100 }
  };
  const network = new vis.Network(container, data, options);

  // Show info on click
  network.on("click", function (params) {
    if (params.nodes.length > 0) {
      const nodeId = params.nodes[0];
      const node = nodes.get(nodeId);
      if(node.info){
        document.getElementById("infoBox").innerText = node.info;
      } else {
        document.getElementById("infoBox").innerText = "Click on an Event ID or command to see details here.";
      }
    }
  });
</script>

</body>
</html>
